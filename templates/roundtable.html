{% extends "layout.html" %}
  
{% block content %}  
<script type="text/javascript">
          // Initialize API key, session, and token...
          // Think of a session as a room, and a token as the key to get in to the room
          // Sessions and tokens are generated on your server and passed down to the client
          var sessionId = "1_MX4zMTQ2MDA1Mn4xMjcuMC4wLjF-VGh1IEp1biAxMyAxMzozNDozMiBQRFQgMjAxM34wLjE1NjgxNzQ0fg";
          var token = genToken();

          TB.setLogLevel(TB.DEBUG);

          // Initialize session, set up event listeners, and connect
          var session = TB.initSession(sessionId);
          session.addEventListener('sessionConnected', sessionConnectedHandler);
          session.addEventListener('streamCreated', streamCreatedHandler);
          session.connect(apiKey, token);
          

          function sessionConnectedHandler(event) {
            var publisher = TB.initPublisher(apiKey, 'myStream');
            session.publish(publisher);

            subscribeToStreams(event.streams);
          }

          function streamCreatedHandler(event) {
            // Subscribe to any new streams that are created
            subscribeToStreams(event.streams);
          }

          function subscribeToStreams(streams) {
            for (var i = 0; i < streams.length; i++) {
              // Make sure we don't subscribe to ourself
              if (streams[i].connection.connectionId == session.connection.connectionId) {
                return;
              }

              // Create the div to put the subscriber element in to
              var div = document.createElement('div');
              div.setAttribute('id', 'stream' + streams[i].streamId);
              div.setAttribute('class', 'stream');
              document.getElementById('roundtable').appendChild(div);

              // Subscribe to the stream
              session.subscribe(streams[i], div.id);

            }

            
          }
  </script>
          <div id='speaker'></div>
          <div class='stream' id='stream1'></div>
          <div class='stream' id='stream2'></div>
          <div class='stream' id='stream3'></div>
          <div class='stream' id='stream4'></div>
          <div class='stream' id='stream5'></div>
          <div class='stream' id='stream6'></div>
          <div class='stream' id='stream7'></div>
          <div class='stream' id='stream8'></div>
          <div id='mystream'></div>
          <div id='options'></div>
          <div id='dialogue'>
            <ul>
              <div id='agenda'><li>Agenda</li></div>
              <li>1.Sample</li>
              <li>2.Sample</li>
              <li>3.Sample</li>
              <li>4.Sample</li>
              <li>5.Sample</li>
              <li>6.Sample</li>

            </ul>
          </div>
{% endblock %}
